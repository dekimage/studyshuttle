import { sendEmailApi } from "@/src/util/sendEmailApi";

const EMAIL_TEMPLATES = {
    1: {
        subject: "Вашиот договор за Фаза 1 на Study Shuttle",
        text: `Почитувани,

Ви благодариме за интересот и желбата да ја започнете Фаза 1 – Фундаментална Фаза на Study Shuttle!

Во прилог на овој имејл ќе го најдете:
Договорот за услугата, во кој се наведени роковите, условите и обврските во Фаза1: Фундаментална фаза.

Потпишете го договорот, скенирајте го и пратете ни го назад (Reply) за да ви исратиме Фактура.

Ве молиме, извршете го плаќањето според наведените упатства во фактурата. Откако ќе ја евидентираме Вашата уплата, ќе ви ги активираме услугите и ќе можете да закажете ОНЛАЈН час со Вашиот ментор.

Доколку имате прашања или Ви е потребна помош околу уплатата, слободно контактирајте нè на studyshuttlemk@gmail.com.

Ви посакуваме успешен и пријатен почеток во Фаза 1!

Поздрав и пријатен ден,
Тимот на Study Shuttle
www.studyshuttle.mk`,
    },
    2: {
        subject: "Вашиот договор за Фаза 2 на Study Shuttle",
        text: `Почитувани,

Честитки за одлуката да продолжите со Фаза 2 – Фаза на Растење во Study Shuttle!

Во прилог на овој имејл ќе го најдете:
Договорот за услугата, во кој се наведени роковите, условите и обврските со Фаза2: Фаза на Растење.

Потпишете го договорот, скенирајте го и пратете ни го назад (Reply) за да ви исратиме Фактура.

Ве молиме да ја извршите уплатата согласно инструкциите во фактурата. По евиденцијата на Вашиот уплатен износ, ќе ви биде омозможен целосен пристап до ОНЛАЈН менторските часови и ресурсите.

Доколку имате прашања или Ви е потребна помош околу уплатата, слободно контактирајте нè на studyshuttlemk@gmail.com.

Ви посакуваме уште поголем успех во Фаза 2 – Фаза на Растење!

Поздрав и пријатен ден,
Тимот на Study Shuttle
www.studyshuttle.mk`,
    },
    3: {
        subject: "Вашиот договор за Фаза 3: Напредна фаза на Study Shuttle",
        text: `Почитувани,

Ви честитаме што стигнавте до Фаза 3 – Напредна Фаза во Study Shuttle! Ова е значаен чекор кон освојување на понапредни академски вештини.

Во прилог на овој имејл ќе го најдете:
Договорот за услугата, во кој се наведени роковите, условите и обврските со Фаза3: Напредна фаза.

Потпишете го договорот, скенирајте го и пратете ни го назад (Reply) за да ви исратиме Фактура.

По успешното плаќање, нашите ментори ќе ви ги поставени на располагање сите напредни ресурси и ќе можеме заеднички да го испланираме Вашиот распоред за претстојните 6 сесии месечно и дополнителни часови по потреба.

Доколку имате прашања или Ви е потребна помош околу уплатата, слободно контактирајте нè на studyshuttlemk@gmail.com.

Продолжете со иста мотивација и желба за успех!

Поздрав и пријатен ден,
Тимот на Study Shuttle
www.studyshuttle.mk`,
    },
    4: {
        subject: "Вашиот договор за Фаза 4: Академска фаза на Study Shuttle",
        text: `Почитувани,

Добредојдовте во Фаза 4 – Академска Фаза на Study Shuttle! Ве очекува 46-неделна програма подготвена и предавана од универзитетски професори по предметот што го одбравте (Математика, Физика, Хемија, Биологија или Програмски јазици).

Во прилог на овој имејл ќе го најдете:
Договорот за услугата, во кој се наведени роковите, условите и обврските со Фаза4: Академска Фаза.

Потпишете го договорот, скенирајте го и пратете ни го назад (Reply) за да ви исратиме Фактура.

Ве молиме да ја извршите уплатата за да можете да ги добиете сите материјали и да започнете со предавањата според договорениот распоред. По приемот на уплатата, Вие или Вашето дете ќе имате директна комуникација со назначените универзитетски професори и достап до сите ресурси.

Доколку имате прашања или Ви е потребна помош околу уплатата, слободно контактирајте нè на studyshuttlemk@gmail.com.

Ви посакуваме плодна и успешна академска авантура!

Поздрав и пријатен ден,
Тимот на Study Shuttle
studyshuttlemk@gmail.com
www.studyshuttle.mk`,
    },
};

export async function POST(request) {
    try {
        const { email, ctaNumber } = await request.json();

        // Basic validation
        if (!email || !ctaNumber) {
            return new Response(
                JSON.stringify({ error: "Email and CTA number are required" }),
                { status: 400 }
            );
        }

        // Get the appropriate email template
        const template = EMAIL_TEMPLATES[ctaNumber];
        if (!template) {
            return new Response(
                JSON.stringify({ error: "Invalid CTA number" }),
                { status: 400 }
            );
        }

        // Send email using sendEmailApi
        const result = await sendEmailApi({
            to: email,
            subject: template.subject,
            text: template.text,
        });

        if (result.error) {
            return new Response(
                JSON.stringify({ error: result.error }),
                { status: 500 }
            );
        }

        return new Response(
            JSON.stringify({ message: "Email sent successfully" }),
            { status: 200 }
        );
    } catch (error) {
        console.error("Error in API route:", error);
        return new Response(
            JSON.stringify({ error: "Internal server error" }),
            { status: 500 }
        );
    }
} 